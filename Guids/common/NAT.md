# Что такое NAT в IP?

**NAT (Network Address Translation)** — это технология, которая позволяет изменять IP-адреса в заголовках пакетов данных во время их передачи через маршрутизатор или брандмауэр. Основная цель NAT — позволить нескольким устройствам в локальной сети (например, домашней или офисной) использовать один публичный IP-адрес для доступа к интернету.

---

### Основные функции NAT:

1. **Экономия IP-адресов:**

    - NAT позволяет использовать один публичный IP-адрес для множества устройств в локальной сети. Это особенно важно, так как IPv4-адреса почти исчерпаны, и NAT помогает экономить их.

2. **Безопасность:**

    - NAT скрывает внутренние IP-адреса устройств от внешнего мира, что добавляет дополнительный уровень безопасности. Внешние пользователи не могут напрямую подключиться к устройствам в локальной сети.

3. **Маршрутизация:**
    - NAT позволяет маршрутизировать пакеты между локальной сетью и интернетом, изменяя IP-адреса и порты в заголовках пакетов.

---

### Как работает NAT:

1. **Локальные и публичные IP-адреса:**

    - Устройства в локальной сети имеют **локальные (частные) IP-адреса**, которые не могут быть использованы в интернете (например, `192.168.1.1`).
    - Маршрутизатор или брандмауэр имеет **публичный IP-адрес**, который используется для доступа к интернету.

2. **Изменение адресов:**

    - Когда устройство в локальной сети отправляет пакет в интернет, NAT-устройство заменяет локальный IP-адрес и порт отправителя на публичный IP-адрес и порт маршрутизатора.
    - Когда ответ возвращается, NAT-устройство заменяет публичный IP-адрес и порт обратно на локальный IP-адрес и порт устройства.

3. **Таблица NAT:**
    - NAT-устройство ведет таблицу, в которой хранит соответствие между локальными и публичными IP-адресами и портами. Это позволяет правильно маршрутизировать пакеты.

---

### Пример работы NAT:

1. Устройство с локальным IP `192.168.1.2` отправляет запрос на сервер в интернете.
2. NAT-устройство заменяет `192.168.1.2:5000` (локальный IP и порт) на `203.0.113.5:5000` (публичный IP и порт).
3. Сервер в интернете получает запрос с IP `203.0.113.5` и отправляет ответ на этот адрес.
4. NAT-устройство получает ответ и заменяет `203.0.113.5:5000` обратно на `192.168.1.2:5000`.
5. Устройство в локальной сети получает ответ.

---

### Типы NAT:

1. **Static NAT (Статический NAT):**

    - Один локальный IP-адрес всегда соответствует одному публичному IP-адресу. Используется для постоянных соответствий.

2. **Dynamic NAT (Динамический NAT):**

    - Локальные IP-адреса динамически сопоставляются с публичными IP-адресами из пула доступных адресов.

3. **PAT (Port Address Translation):**
    - Расширение NAT, которое позволяет использовать один публичный IP-адрес для множества устройств, изменяя порты. Это наиболее распространенный тип NAT.

---

### Преимущества NAT:

- Экономия IP-адресов.
- Повышение безопасности за счет скрытия внутренних IP-адресов.
- Упрощение управления сетью.

---

### Недостатки NAT:

- Усложняет работу некоторых приложений, которые требуют прямого доступа к устройствам (например, P2P-сети).
- Может вызывать проблемы с производительностью из-за дополнительной нагрузки на маршрутизатор.

---

### NAT и IPv6:

В IPv6 NAT практически не используется, так как адресное пространство IPv6 настолько велико, что каждое устройство может иметь уникальный публичный IP-адрес. Это устраняет необходимость в NAT и упрощает маршрутизацию.

---

---

# Где находится NAT и как изменить тип его работы?

**NAT (Network Address Translation)** обычно реализуется в **маршрутизаторе** или **брандмауэре**, который соединяет локальную сеть (например, домашнюю или офисную) с внешней сетью (интернетом). Маршрутизатор или брандмауэр выполняет функции NAT, изменяя IP-адреса и порты в заголовках пакетов данных.

---

## Где находится NAT?

1. **В маршрутизаторе:**

    - Большинство домашних и офисных маршрутизаторов (например, Wi-Fi роутеры) имеют встроенную поддержку NAT.
    - NAT позволяет всем устройствам в локальной сети использовать один публичный IP-адрес для доступа к интернету.

2. **В брандмауэре:**

    - Корпоративные сети часто используют брандмауэры с функцией NAT для управления трафиком между локальной сетью и интернетом.

3. **В серверах или специализированных устройствах:**
    - В крупных сетях NAT может быть реализован на специализированных серверах или устройствах, которые выполняют функции маршрутизации и трансляции адресов.

---

## Как изменить тип работы NAT?

Тип работы NAT можно изменить в настройках маршрутизатора, брандмауэра или устройства, где он реализован. Вот основные шаги:

---

### 1. Доступ к настройкам маршрутизатора

1. Откройте веб-интерфейс маршрутизатора:

    - Введите IP-адрес маршрутизатора в браузере (например, `192.168.1.1` или `192.168.0.1`).
    - Войдите в систему, используя логин и пароль (по умолчанию это может быть `admin/admin` или `admin/password`).

2. Найдите раздел настроек NAT:
    - Обычно он находится в меню **Advanced** (Дополнительно) > **NAT** или **Firewall** (Брандмауэр).

---

### 2. Типы NAT и их настройка

#### **Static NAT (Статический NAT):**

- Один локальный IP-адрес всегда соответствует одному публичному IP-адресу.
- Используется для постоянных соответствий, например, когда нужно сделать сервер в локальной сети доступным из интернета.
- Настройка:
    1. В разделе NAT выберите **Static NAT** или **Port Forwarding** (Переадресация портов).
    2. Укажите локальный IP-адрес и порт, которые нужно сопоставить с публичным IP-адресом и портом.
    3. Сохраните изменения.

#### **Dynamic NAT (Динамический NAT):**

- Локальные IP-адреса динамически сопоставляются с публичными IP-адресами из пула доступных адресов.
- Используется, когда у вас есть несколько публичных IP-адресов, и вы хотите распределить их между устройствами в локальной сети.
- Настройка:
    1. В разделе NAT выберите **Dynamic NAT**.
    2. Укажите диапазон публичных IP-адресов, которые будут использоваться для трансляции.
    3. Сохраните изменения.

#### **PAT (Port Address Translation):**

- Это наиболее распространенный тип NAT, который позволяет использовать один публичный IP-адрес для множества устройств, изменяя порты.
- Настройка:
    1. В разделе NAT выберите **PAT** или **NAT Overload**.
    2. Укажите публичный IP-адрес, который будет использоваться для трансляции.
    3. Сохраните изменения.

---

### 3. Пример настройки PAT (Port Address Translation):

1. Войдите в веб-интерфейс маршрутизатора.
2. Перейдите в раздел **Advanced** > **NAT**.
3. Выберите **PAT** или **NAT Overload**.
4. Укажите публичный IP-адрес маршрутизатора.
5. Сохраните изменения.

---

### 4. Проверка работы NAT

1. После изменения настроек NAT перезагрузите маршрутизатор.
2. Проверьте, что устройства в локальной сети могут выходить в интернет.
3. Убедитесь, что внешние пользователи не могут напрямую подключиться к устройствам в локальной сети (если это не требуется).

---

### 5. Отключение NAT

Если вы хотите полностью отключить NAT (например, если у вас есть публичные IP-адреса для всех устройств), выполните следующие шаги:

1. В веб-интерфейсе маршрутизатора перейдите в раздел **NAT**.
2. Отключите NAT или выберите опцию **Disable NAT**.
3. Сохраните изменения и перезагрузите маршрутизатор.

---

### Итог:

NAT обычно находится в маршрутизаторе или брандмауэре. Вы можете изменить тип работы NAT в настройках устройства, выбрав нужный режим (Static NAT, Dynamic NAT или PAT). Если NAT не требуется, его можно полностью отключить.
