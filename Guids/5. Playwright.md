### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ end-to-end (E2E) —Ç–µ—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Playwright

#### **1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Playwright**

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Playwright –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
yarn create playwright
```

**–í–æ–∑–º–æ–∂–Ω–∞—è –æ—à–∏–±–∫–∞:**

–ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π:

```
error @achrinza/node-ipc@9.2.5: The engine "node" is incompatible with this module. Expected version "8 || 9 || 10 || 11 || 12 || 13 || 14 || 15 || 16 || 17 || 18". Got "20.10.0"
```

**–†–µ—à–µ–Ω–∏–µ:**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Node.js –≤–µ—Ä—Å–∏–∏ 18. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ—ë —Å –ø–æ–º–æ—â—å—é `nvm`:

```bash
nvm use v18
```

## –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—è–≤—è—Ç—Å—è —Å–ª—É–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏:

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Playwright –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:

- playwright.config.ts
- tests
- tests-examples
- test-results (—Å–∫—Ä—ã—Ç–∞—è –ø–∞–ø–∫–∞)
- [playwright.yml](playwright_yml.md)

```bash
yarn playwright test
```

Playwright –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á—ë—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
yarn playwright show-report
```

–¢–µ–ø–µ—Ä—å Playwright —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.

---

#### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Playwright**

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (local, staging, production) –¥–æ–±–∞–≤–∏–º `baseURL` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Playwright.

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç `dotenv` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

    ```bash
    yarn add -D dotenv
    ```

2. –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª `playwright.config.ts`:

    ```typescript
    import dotenv from 'dotenv'

    dotenv.config()

    export default {
        use: {
            // –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `await page.goto('/')`)
            baseURL: process.env.TEST_ENV_BASE_URL,

            // –í–∫–ª—é—á–∏—Ç—å —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤
            trace: 'on-first-retry',
        },
    }
    ```

3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª—ã `.env` –∏ `.env.example`:

    ```
    TEST_ENV_BASE_URL=http://localhost:3333
    ```

–¢–µ–ø–µ—Ä—å Playwright –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–π `baseURL` –≤ —Ç–µ—Å—Ç–∞—Ö.

---

#### **3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é Playwright Codegen**

Playwright –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

- [–î–æ–∫–∞ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤](https://playwright.dev/docs/codegen-intro)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ—Å—Ç–æ–≤:

    ```bash
    npx playwright codegen
    ```

    –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞. –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://localhost:3333`).

    **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ:** –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É —É–∫–∞–∑–∞—Ç—å URL –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

    ```bash
    npx playwright codegen http://localhost:3333
    ```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ. Playwright –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ —Ç–µ—Å—Ç–∞.

    –ü—Ä–∏–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:

    ```typescript
    import {expect, test} from '@playwright/test'

    test('test', async ({page}) => {
        await page.goto('http://localhost:3333/')
        await page.getByText('MoviesOptions Components').click()
        await page.getByRole('link', {name: 'My movies'}).click()
        await expect(
            page.getByRole('button', {name: 'MY-MOVIES'}),
        ).toBeVisible()
        await page.getByRole('button', {name: 'MY-MOVIES'}).click()
        await page.getByRole('link', {name: 'Search movies'}).click()
        await expect(
            page.getByRole('button', {name: 'Add movies'}),
        ).toBeVisible()
        await page.getByRole('button', {name: 'Add movies'}).click()
        await expect(page.locator('.p-4').first()).toBeVisible()
        await page.locator('.h-48').first().click()
        await expect(page.locator('.h-48').first()).toBeVisible()
        await page.goto('http://localhost:3333/search-movies')
    })
    ```

---

#### **4. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞**

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `movie-search.test.ts` –≤ –ø–∞–ø–∫–µ `tests` (—ç—Ç–æ –ø–∞–ø–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ç–µ—Å—Ç–æ–≤ Playwright).

2. –í—Å—Ç–∞–≤—å—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥, –∑–∞–º–µ–Ω–∏–≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –Ω–∞ `/` –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–≤ —Ç–µ—Å—Ç:

    ```typescript
    import {expect, test} from '@playwright/test'

    test('movie-search', async ({page}) => {
        await page.goto('/')
        await page.getByText('MoviesOptions Components').click()
        await page.getByRole('link', {name: 'My movies'}).click()
        await expect(
            page.getByRole('button', {name: 'MY-MOVIES'}),
        ).toBeVisible()
        await page.getByRole('button', {name: 'MY-MOVIES'}).click()
        await page.getByRole('link', {name: 'Search movies'}).click()
        await expect(
            page.getByRole('button', {name: 'Add movies'}),
        ).toBeVisible()
        await page.getByRole('button', {name: 'Add movies'}).click()
    })
    ```

3. –£–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ Playwright (–ø–∞–ø–∫–∞ `tests-examples`).

---

#### **5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –≤ `package.json`**

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤ `package.json`:

```json
"scripts": {
  "testp": "npx playwright test",
  "testp:headed": "npx playwright test --headed",
  "testp:chrome": "npx playwright test --project=chromium",
  "testp:firefox": "npx playwright test --project=firefox",
  "testp:webkit": "npx playwright test --project=webkit",
  "testp:report": "npx playwright test --reporter=html"
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥:**

- **`testp`**: –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –≤ headless-—Ä–µ–∂–∏–º–µ (–±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞).
- **`testp:headed`**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ headed-—Ä–µ–∂–∏–º–µ (—Å –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –±—Ä–∞—É–∑–µ—Ä–∞). –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
- **`testp:chrome`**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ Chrome (Chromium).
- **`testp:firefox`**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ Firefox.
- **`testp:webkit`**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ Safari (WebKit).
- **`testp:report`**: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π HTML-–æ—Ç—á—ë—Ç–∞. –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫–µ `playwright-report`.

---

### **–ò—Ç–æ–≥**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã end-to-end —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Playwright. –í—ã –º–æ–∂–µ—Ç–µ:

- –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (local, staging, production).
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–º–æ—â—å—é `codegen`.
- –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö –∏ —Ä–µ–∂–∏–º–∞—Ö.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä
